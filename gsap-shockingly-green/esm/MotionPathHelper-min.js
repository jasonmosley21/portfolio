/*!
 * MotionPathHelper 3.11.3
 * https://greensock.com
 *
 * @license Copyright 2008-2022, GreenSock. All rights reserved.
 * Subject to the terms at https://greensock.com/standard-license or for
 * Club GreenSock members, the agreement issued with that membership.
 * @author: Jack Doyle, jack@greensock.com
*/
import PathEditor from"./utils/PathEditor.js";var gsap,_win,_doc,_docEl,_body,MotionPathPlugin,_arrayToRawPath,_rawPathToString,_context,_copyElement,_bonusValidated=1,_selectorExp=/(^[#\.][a-z]|[a-y][a-z])/i,_isString=function(t){return"string"==typeof t},_createElement=function(t,e){var o=_doc.createElementNS?_doc.createElementNS((e||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),t):_doc.createElement(t);return o.style?o:_doc.createElement(t)},_getPositionOnPage=function(t){var e=t.getBoundingClientRect(),o=_docEl.clientTop-(_win.pageYOffset||_docEl.scrollTop||_body.scrollTop||0),a=_docEl.clientLeft-(_win.pageXOffset||_docEl.scrollLeft||_body.scrollLeft||0);return{left:e.left+a,top:e.top+o,right:e.right+a,bottom:e.bottom+o}},_getInitialPath=function(t,e){var o,a=[0,31,8,58,24,75,40,90,69,100,100,100];for(o=0;o<a.length;o+=2)a[o]+=t,a[o+1]+=e;return"M"+t+","+e+"C"+a.join(",")},_getGlobalTime=function(t){for(var e=t.totalTime();t;)e=t.startTime()+e/(t.timeScale()||1),t=t.parent;return e},_initCopyToClipboard=function(){(_copyElement=_createElement("textarea")).style.display="none",_body.appendChild(_copyElement)},_parsePath=function(t,e,o){return _isString(t)&&_selectorExp.test(t)?_doc.querySelector(t):Array.isArray(t)?_rawPathToString(_arrayToRawPath([{x:gsap.getProperty(e,"x"),y:gsap.getProperty(e,"y")}].concat(t),o)):_isString(t)||t&&"path"===(t.tagName+"").toLowerCase()?t:0},_addCopyToClipboard=function(t,e,o){t.addEventListener("click",(function(a){if(a.target._gsHelper){var n=e(a.target);if(_copyElement.value=n,n&&_copyElement.select){console.log(n),_copyElement.style.display="block",_copyElement.select();try{_doc.execCommand("copy"),_copyElement.blur(),o&&o(t)}catch(t){console.warn("Copy didn't work; this browser doesn't permit that.")}_copyElement.style.display="none"}}}))},_identityMatrixObject={matrix:{a:1,b:0,c:0,d:1,e:0,f:0}},_getConsolidatedMatrix=function(t){return(t.transform.baseVal.consolidate()||_identityMatrixObject).matrix},_findMotionPathTween=function(t){for(var e=gsap.getTweensOf(t),o=0;o<e.length;o++){if(e[o].vars.motionPath)return e[o];e[o].timeline&&e.push.apply(e,e[o].timeline.getChildren())}},_initCore=function(t,e){var o="Please gsap.registerPlugin(MotionPathPlugin)";_win=window,(gsap=gsap||t||_win.gsap||console.warn(o))&&PathEditor.register(gsap),_doc=document,_body=_doc.body,_docEl=_doc.documentElement,gsap&&(MotionPathPlugin=gsap.plugins.motionPath,_context=gsap.core.context||function(){}),MotionPathPlugin?(_initCopyToClipboard(),_arrayToRawPath=MotionPathPlugin.arrayToRawPath,_rawPathToString=MotionPathPlugin.rawPathToString):!0===e&&console.warn(o)};export var MotionPathHelper=function(){function t(t,e){var o=this;void 0===e&&(e={}),MotionPathPlugin||_initCore(e.gsap,1);var a,n,r,i,s,l,p,c,d,g,h,_,u,y=_createElement("div"),f=this,m={x:0,y:0};t instanceof gsap.core.Tween?a=(c=t).targets()[0]:(a=gsap.utils.toArray(t)[0],c=_findMotionPathTween(a)),n=_parsePath(e.path,a,e),this.offset=m,l=_getPositionOnPage(a),i=parseFloat(gsap.getProperty(a,"x","px")),s=parseFloat(gsap.getProperty(a,"y","px")),r=a.getCTM&&"svg"!==a.tagName.toLowerCase(),c&&!n&&(n=_parsePath(c.vars.motionPath.path||c.vars.motionPath,a,c.vars.motionPath)),y.setAttribute("class","copy-motion-path"),y.style.cssText="border-radius:8px; background-color:rgba(85, 85, 85, 0.7); color:#fff; cursor:pointer; padding:6px 12px; font-family:Signika Negative, Arial, sans-serif; position:fixed; left:50%; transform:translate(-50%, 0); font-size:19px; bottom:10px",y.innerText="COPY MOTION PATH",y._gsHelper=f,(gsap.utils.toArray(e.container)[0]||_body).appendChild(y),_addCopyToClipboard(y,(function(){return f.getString()}),(function(){return gsap.fromTo(y,{backgroundColor:"white"},{duration:.5,backgroundColor:"rgba(85, 85, 85, 0.6)"})})),(p=n&&n.ownerSVGElement)?(e.pathColor&&gsap.set(n,{stroke:e.pathColor}),e.pathWidth&&gsap.set(n,{strokeWidth:e.pathWidth}),e.pathOpacity&&gsap.set(n,{opacity:e.pathOpacity})):(d=r&&a.ownerSVGElement&&a.ownerSVGElement.getAttribute("xmlns")||"http://www.w3.org/2000/svg",r?(p=a.ownerSVGElement,g=a.getBBox(),i=(h=_getConsolidatedMatrix(a)).e,s=h.f,m.x=g.x,m.y=g.y):(p=_createElement("svg",d),_body.appendChild(p),p.setAttribute("viewBox","0 0 100 100"),p.setAttribute("class","motion-path-helper"),p.style.cssText="overflow:visible; background-color: transparent; position:absolute; z-index:5000; width:100px; height:100px; top:"+(l.top-s)+"px; left:"+(l.left-i)+"px;"),g=_isString(n)&&!_selectorExp.test(n)?n:_getInitialPath(i,s),(n=_createElement("path",d)).setAttribute("d",g),n.setAttribute("vector-effect","non-scaling-stroke"),n.style.cssText="fill:transparent; stroke-width:"+(e.pathWidth||3)+"; stroke:"+(e.pathColor||"#555")+"; opacity:"+(e.pathOpacity||.6),p.appendChild(n)),(m.x||m.y)&&gsap.set(n,{x:m.x,y:m.y}),"selected"in e||(e.selected=!0),"anchorSnap"in e||(e.anchorSnap=function(t){t.x*t.x+t.y*t.y<16&&(t.x=t.y=0)}),u=c&&"nested"===c.parent.data?c.parent.parent:c,e.onPress=function(){u.pause(0)},_=function(){c.invalidate(),u.restart()},e.onRelease=e.onDeleteAnchor=_,this.editor=PathEditor.create(n,e),e.center&&gsap.set(a,{transformOrigin:"50% 50%",xPercent:-50,yPercent:-50}),c?(c.vars.motionPath.path?c.vars.motionPath.path=n:c.vars.motionPath={path:n},u.parent!==gsap.globalTimeline&&gsap.globalTimeline.add(u,_getGlobalTime(u)-u.delay()),u.repeat(-1).repeatDelay(1)):c=u=gsap.to(a,{motionPath:{path:n,start:e.start||0,end:"end"in e?e.end:1,autoRotate:"autoRotate"in e&&e.autoRotate,align:n,alignOrigin:e.alignOrigin},duration:e.duration||5,ease:e.ease||"power1.inOut",repeat:-1,repeatDelay:1,paused:!e.path}),this.animation=c,_context(this),this.kill=this.revert=function(){o.editor.kill(),y.parentNode&&y.parentNode.removeChild(y),r||p.parentNode&&p.parentNode.removeChild(p),u&&u.revert()}}return t.prototype.getString=function(){return this.editor.getString(!0,-this.offset.x,-this.offset.y)},t}();MotionPathHelper.register=_initCore,MotionPathHelper.create=function(t,e){return new MotionPathHelper(t,e)},MotionPathHelper.editPath=function(t,e){return PathEditor.create(t,e)},MotionPathHelper.version="3.11.3";export{MotionPathHelper as default};